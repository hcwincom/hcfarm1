<include file="portal@thj/head" />
<body>
    <include file="portal@thj/header" />
    <div class="main">
        <!--  -->
        <div class="personal2">
            <h6 class="appctitle">
                <strong>请完善以下信息 </strong>
                (注：
                <em class="redcolor"> * </em> 为必填项)
            </h6>

            <form action="" method="POST" >
                <div class="item appc1">
                    <span class="label">
                        <span class="redcolor">*</span>
                        券卡编号：
                    </span>
                    <div class="fl">
                        <input style="border: none; color: #d5000d;font-weight: 600;font-size: 18px;" type="text" class="itxt" id="sn" value="{$info.sn}" readonly>
                    </div>
                </div>
                <div class="item appc1">
                    <span class="label">
                        <span class="redcolor">*</span>
                        理赔原因：
                    </span>
                    <div class="fl">
                        <textarea style="float: left;" class="itxt" name="dsc" maxlength="200" id="description" onkeyup="value=value.replace(/\s/g,'')"></textarea>
                        <span class="error-msg" id="showdescription">
                            请填写理赔原因
                        </span>
                    </div>
                </div>
                <p class="orangrc" style="padding-left:20px;">请填写需要理赔的方式</p>
                <div class="item appc1">
                    <span class="label">
                        <span class="redcolor">*</span>
                        理赔凭证图1：
                    </span>
                    <div class="fl">
                    <neq name="info.status" value="8">
                        <input type="file"  id="picurl1" value="" class="file file1 itxt" />
                    </neq>
                        <input type="hidden" name="pic1" value="{$back.pic1}" class="filepath filepath1" />
                        <span class="error-msg" id="showpicurl1">
                            请上传理赔凭证图
                        </span>
                    </div>
                </div>
                <div class="item appc1">
                    <span class="label">
                        <span class="redcolor"></span>
                        理赔凭证图2：
                    </span>
                    <div class="fl">
                        <neq name="info.status" value="8">
                        <input type="file" value="" class="file file2" />
                        </neq>
                        <input type="hidden" name="pic2" value="{$back.pic1}"  class="filepath filepath2" />
                    </div>
                </div>
                <div class="item appc1">
                    <span class="label">
                        <span class="redcolor"></span>
                        理赔凭证图3：
                    </span>
                    <div class="fl">
                        <neq name="info.status" value="8">
                        <input type="file" id="picurl3" value="" class="file file3" />
                        </neq>
                        <input type="hidden" name="pic3" value="{$back.pic1}" class="filepath filepath3" />
                    </div>
                </div>
                <neq name="info.status" value="8">
                <div class="item appc1">
                    <span class="label">&nbsp;</span>
                    <div class="fl">
                        <input type="button" class="btn-9 bgred" value="提交" id="backBtn">
                    </div>
                </div>
                </neq>
                <div class="item appc1">
                    <span class="label">&nbsp;</span>
                    <div class="fl">
                       <p class="codeMsg colorred"></p>
                    </div>
                </div>

                <!--  -->
            </form>
      
        </div>




        <!--  -->
    </div>

    <!--底部-->
    <include file="portal@thj/footer" />

        <script type="text/javascript" src="__TMPL__/public/thj/js/jquery-1.12.1.min.js"></script>
        <script type="text/javascript" src="__TMPL__/public/thj/js/index.js"></script>
        <script type="text/javascript" src="__TMPL__/public/thj/js/form.js"></script>
        <include file="portal@thj/thjs" />
      <script>
         //上传图片
            $('.file').change(function () {
                //组装表单数据
                var fordata = new FormData();
                var file = this.files[0];
                var sn = $('#sn').val();
                var $filepath = $(this).siblings('file_path');
                fordata.append("file", file);
                fordata.append("dir", 'voucher/' + sn);
                //ajax
                $.ajax({
                    "url": "{:url('portal/public/upload')}",
                    "type": "POST",
                    "processData": false,
                    "contentType": false,
                    "data": fordata,
                    "dataType": "json",
                    "error": function () {
                        console.log('上传失败');
                        click = 0;
                    },
                    "success": function (data) {
                        console.log(data);
                        console.log(data.msg);

                        $filepath.val(data.data.path);
                        click = 0;
                    }
                });
            });

      </script>
</body>
</html>